# مواصفات دعم AI Chat Bot – مساعدة المستخدم

## 1. ما هو الهدف الأساسي من Chat Bot؟

| الهدف | الحالة الحالية | ملاحظات |
|--------|-----------------|----------|
| **مساعدة المستخدم** | ✅ مدعوم | الـ Bot يجيب عن أسئلة المستخدم بناءً على بيانات التطبيق. |
| **الإجابة على الأسئلة** | ✅ مدعوم | يعتمد على Google Gemini مع سياق (المنتجات، والعروض، والـ FAQs عند تفعيل التوسعات). |
| **التوجيه لصفحات التطبيق** | ⚠️ جزئي | يمكن للـ Bot أن يذكر أسماء الصفحات أو الإجراءات؛ التوجيه الفعلي (روابط/تنقل) يتم من واجهة التطبيق. |
| **دعم فني سريع** | ✅ مدعوم | يمكن تضمين أسئلة شائعة ودليل دفع/طلبات في سياق الـ Bot. |

**الخلاصة:** الهدف الأساسي هو **مساعدة المستخدم + الإجابة على الأسئلة + دعم فني سريع**، مع إمكانية التوجيه النصي لصفحات التطبيق (التنفيذ الفعلي في الواجهة الأمامية).

---

## 2. هل يوجد زر دائم لفتح المحادثة في كل صفحة؟

| الحالة | الوصف |
|--------|--------|
| **الـ Backend (API)** | لا يتحكم في واجهة المستخدم. |
| **الواجهة الأمامية (Frontend)** | يُنصح بتوفير **زر عائم (FAB) أو أيقونة دائمة** في كل صفحة لفتح نافذة/شاشة المحادثة. |

**توصية:** في تطبيق الويب/الجوال (مثل Vercel أو React Native)، إضافة مكون زر ثابت (مثلاً أسفل يمين الشاشة) يفتح الـ Chat في كل الصفحات.

---

## 3. ما هي اللغات المدعومة للتواصل مع الـ Chat Bot؟

| الحالة الحالية | التفاصيل |
|-----------------|-----------|
| **اللغات** | الـ API لا يفرض لغة محددة. المستخدم يرسل `question` بأي لغة (عربي، إنجليزي، إلخ). |
| **Gemini** | يدعم لغات متعددة، لذا يمكن الرد **بالعربية أو الإنجليزية** حسب لغة السؤال أو إعدادات الـ prompt. |

**توصية:** إضافة معامل اختياري في الطلب مثل `lang` أو `locale` (مثل `ar` أو `en`) واستخدامه في الـ prompt لطلب الرد بنفس لغة المستخدم.

---

## 4. أنواع الأسئلة التي يمكن أن يجيب عليها الـ Chat Bot

| النوع | الحالة الحالية | بعد التوسعات المضافة |
|--------|-----------------|------------------------|
| **أسئلة عامة (FAQs)** | ⚠️ غير مضمّن في السياق | ✅ يتم إرسال قائمة الـ FAQs النشطة إلى الـ AI ليجيب منها. |
| **حالة الطلبات / تتبع آخر طلب** | ❌ لا | ✅ الـ Bot يشرح كيف يتتبع المستخدم طلبه ويوجهه لصفحة الطلبات أو تتبع الطلب. |
| **الدفع وطرق الدفع** | ❌ لا | ✅ يشرح طرق الدفع (بطاقة، دفع عند الاستلام) ويوجه للدفع. |
| **المنتجات والمفضلة والقوائم** | ✅ نعم | ✅ يعتمد على قائمة المنتجات الحالية؛ يمكن توسيعه لذكر المفضلة والقوائم الذكية إن أُضيفت للسياق. |
| **العروض والكوبونات** | ⚠️ جزئي | ✅ يتم إرسال العروض النشطة وأكواد الخصم للـ AI ليجيب عنها. |

**الخلاصة:** بعد التعديلات على الـ Backend، الـ Bot يصبح قادراً على الإجابة عن **الأسئلة العامة، الطلبات، الدفع، المنتجات والمفضلة، والعروض والكوبونات** ضمن حدود البيانات المُرسلة في السياق.

---

## 5. هل يمكن للمستخدم كتابة أي سؤال بحرية أم يقتصر على خيارات محددة؟

| الوضع | الوصف |
|--------|--------|
| **الكتابة الحرة** | ✅ مدعومة. المستخدم يرسل أي نص في الحقل `question` (حتى حد الطول المسموح، مثلاً 1000 حرف). |
| **خيارات محددة** | اختياري. يمكن للواجهة عرض **اقتراحات جاهزة** (أسئلة سريعة) من endpoint مثل `GET /api/chatbot/suggestions` مع الاستمرار في السماح بكتابة سؤال حر. |

**الخلاصة:** المستخدم **يستطيع كتابة أي سؤال بحرية**؛ الخيارات المحددة تكون لمساعدة أسرع فقط وليست إلزامية.

---

## 6. هل يوجد تاريخ المحادثة يمكن للمستخدم مراجعته لاحقاً؟

| الحالة الحالية | بعد التعديلات |
|-----------------|----------------|
| ❌ لا يُحفظ تاريخ في الـ API الحالي. | ✅ يُحفظ كل سؤال وجواب مرتبط بالمستخدم. |
| | ✅ endpoint مثل `GET /api/chatbot/history` يعيد المحادثات السابقة (مع ترقيم الصفحات). |

**الخلاصة:** بعد تفعيل ميزة السجل في الـ Backend، **يوجد تاريخ محادثة** ويمكن للمستخدم مراجعته لاحقاً من التطبيق عبر الـ API.

---

## 7. هل يمكن للـ Chat Bot التعامل مع استفسارات متعددة في نفس الوقت؟

| المستوى | الوصف |
|---------|--------|
| **من واجهة المستخدم** | يعتمد على التطبيق: إن سمح المستخدم بإرسال عدة طلبات متتالية سريعة، يمكن وجود أكثر من طلب "مفتوح" في نفس الوقت. |
| **من الـ API** | كل طلب `POST /api/chatbot` مستقل. لا يوجد قفل يمنع طلبات متعددة من نفس المستخدم. |
| **السلوك العملي** | يُفضّل في الواجهة تعطيل زر الإرسال حتى اكتمال الرد (أو استخدام طابور) لتجنب تداخل الردود. |

**الخلاصة:** الـ API **يقبل استفسارات متعددة** من نفس المستخدم؛ تنظيم العرض والمنع من الإرباك يتم في الواجهة الأمامية.

---

## 8. هل يتم عرض اقتراحات تلقائية أثناء كتابة السؤال؟

| الحالة | التفاصيل |
|--------|-----------|
| **الـ Backend** | يمكن توفير **قائمة اقتراحات ثابتة أو ديناميكية** عبر `GET /api/chatbot/suggestions` (أسئلة شائعة، تتبع طلب، دفع، منتجات، عروض). |
| **أثناء الكتابة (Auto-suggest)** | البحث التلقائي أثناء الكتابة (مثل اقتراح إكمال الجملة) يمكن تنفيذه في الواجهة فقط (مثلاً من قائمة الـ suggestions أو بحث محلي)، والـ API لا يلزم بتوفير "اقتراح حي" أثناء الكتابة. |

**توصية:** عرض اقتراحات جاهزة (أزرار أو قائمة) عند فتح الشات أو فوق حقل الإدخال، مع إمكانية إضافة اقتراحات تلقائية أثناء الكتابة في الواجهة لاحقاً.

---

## 9. هل يمكن للمستخدم تقييم إجابات الـ Chat Bot؟

| الحالة الحالية | بعد التعديلات |
|-----------------|----------------|
| ❌ لا يوجد تقييم في الـ API. | ✅ يمكن إرسال **تقييم** مع الطلب أو في طلب منفصل. |
| | مثال: حقل اختياري `rating` (1–5) في `POST /api/chatbot` أو `POST /api/chatbot/feedback` مع معرف الرسالة. |
| | يُخزَّن التقييم مع رسالة المحادثة لتحليل الجودة لاحقاً. |

**الخلاصة:** بعد تفعيل ميزة التقييم في الـ Backend، **نعم** يمكن للمستخدم تقييم إجابات الـ Bot.

---

## ملخص الـ API (مُنفَّذ)

| الميزة | Endpoint | الوصف |
|--------|----------|--------|
| إرسال سؤال + حفظ في السجل + تقييم اختياري | `POST /api/chatbot` | Body: `question` (مطلوب)، `rating` (اختياري 1–5)، `locale` (اختياري: `ar` أو `en`). |
| تاريخ المحادثة | `GET /api/chatbot/history` | ترقيم الصفحات (`per_page`, `page`)، لكل مستخدم مصادق. |
| اقتراحات أسئلة | `GET /api/chatbot/suggestions` | Query: `locale=ar` أو `en`. يرجع قائمة اقتراحات (FAQs، طلبات، دفع، منتجات، عروض). |

---

## ملخص سريع (نعم/لا)

| السؤال | الإجابة بعد التنفيذ الكامل |
|--------|----------------------------|
| هدف الـ Bot: مساعدة + إجابات + دعم فني | ✅ نعم |
| زر دائم في كل صفحة | ⚠️ في الواجهة الأمامية (موصى به) |
| لغات متعددة | ✅ نعم (عربي/إنجليزي/أخرى حسب الـ prompt) |
| FAQs، طلبات، دفع، منتجات، عروض | ✅ نعم |
| سؤال حر + خيارات مقترحة | ✅ نعم |
| تاريخ محادثة | ✅ نعم (عبر الـ API) |
| استفسارات متعددة في نفس الوقت | ✅ مقبول من الـ API؛ التحكم من الواجهة |
| اقتراحات تلقائية | ✅ قائمة اقتراحات من API؛ أثناء الكتابة من الواجهة |
| تقييم الإجابات | ✅ نعم (حقل rating أو endpoint feedback) |
